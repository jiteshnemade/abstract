introduction    two phase flow regime is an important concept for severe accident prediction and prevention in two phase flow systems  such as the reactor pressure vessel in the nuclear power plant. it serves as an engineering reference that classifies flow  characteristics. many two phase flow models are based on flow regimes. thus  an accurate prediction on flow regime  can be regarded as the first step towards an accurate two phase flow prediction. the analysis of the two phase flow  regime and its transitions has quite a long history. flow regime maps were developed for different flow geometries           . flow regimes are determined by using two phase parameters that can be experimentally obtained. in the early  times  the flow regime maps are either created using experimental data or theoretical approaches    . recently  the flow  regime identifications are developed with the help of machine learning techniques.  over the past years  exclusive work has been done on two phase flow regime identification using machine learning  algorithms. among them  supervised multi layer feedforward neural networks  nn   supported vector machine  svm       and self organized map  som      are the most used algorithms and other generated algorithms are more or less  based on these algorithms.           they basically require to input all the data to extract the different key features  and make predictions. although these methods are proved to be accurate  certain shortcomings of these methods  are     most of the algorithms are determining static flow regime maps that are used as engineering references  while  the structures and two phase flow is changing dynamically     the flow regime are only be determined afterwards.  however  severe accidents  such as nuclear power plant core melting  often happens at sudden  a fast response and  accident prediction is essentially needed. in this paper  a dynamic rnn approach is proposed for the two phase flow  regime prediction. a lstm based deep rnn is constructed and trained using existing database and the performance is  evaluated and analyzed in this paper.         recurrent neural network    rnn is structurally suitable for a time series prediction. conventional rnn can process time series data temporally  and dynamically based on hidden markov model  hmm   which makes rnn to be able to capture long distance       email  zdang purdue.edu     dependencies. however  rnn could fall into the trouble of gradient vanishing and exploring during model training.  long short term memory  lstm  networks     was created and solved this problem properly by managing the passes  of the information. in a lstm system  the recurrent hidden layers are computing with the self connected memory  cells and three gates for obtaining the outputs. the key of lstm in solving the gradient vanishing and exploring is to  optionally ignore some of the inputs so that they aren t used for the updates of parameters in the hidden states.  given a time dependent void fraction sequence                     ...   n    the mathematical expressions for the operation  of one lstm hidden cell t  are given as follows   it      w i  t   whi ht     wci ct     bi    ft      w f xt   whf ht     wcf ct     bf    at      w c  t   whc ht     bc    ct   ft ct     it at  ot      w o  t   who ht     wco ct   bo    ht   ot    ct             where w is the weights for each parameter at certain state. ht is the vector sequence of the hidden cell. in this model  the  activation functions are sigmoid function     and tanh function    . a lstm system usually contains multiple connected  cells among which the outputs from the preceding cell are the inputs of the following cell. the characteristics of the  two phase flow is able to pass thought the model. the output of the model is a probability distribution of all the possible  flow regimes. the predicted flow regime is the one with the highest probability  obtained as follows   the prediction on flow regime using lstm based rnn has its advantages. firstly  the input sequence is segmented.  each input node in the sequence represents the state of the flow regime at certain time. secondly  the relation between  the sequence and the output is rather tight since the sequence hardly contains unrelated noises. however  since the  mechanisms in related with the transition and development of the two phase flow regime is complicated and the number  of dependencies is large  a deep lstm network is still needed.  this paper follows a similar approach of constructing deep lstm network with     . their ideas of constructing deep  rnn network is as follows     input hidden     hidden hidden     hidden output. based on the ideas    different types  of rnn network are constructed by combining different sublayers. in terms of constructing the network  one important  consideration is that with the basis of accuracy  the network should respond quickly. this means that the setting of the  number of the parameters should balance both the requirement of accuracy and the calculation latency.    figure    structure of lstm cell               figure    example of structure of   lstm rnn hidden layers         experiments    we evaluated the lstm based d rnn on the current existing time series void fraction signal database    . the details  on experiment setup  database  and the experimental results are discussed below.   .     database    the two phase flow regime parameters that can describe the flow regime could be classified into two groups. the  parameters in the first group directly describe the flow regime characteristics  such as void fraction and interfacial area  concentration. the parameters in the second group also include the flow regime characteristics such as local pressure in  the system. since parameters in both groups include the characteristics of flow regime  they could be used as the input  parameters for the flow regime prediction.  time series data containing two phase flow regime characteristics can be obtained using many two phase flow measurement instrumentations. in the lab setup  gamma densitometer is a very accurate and stable method because it is  non intrusive  almost flow regime dependence free instrumentation.      conductivity probe is another accurate instrumentation yet its setup is relatively difficult. impedance void meter  as an engineering reference  is also non intrusive  yet its accuracy dependence on the flow regime and void distribution.     in terms of industrial application  differential  pressure gauge is a convenient and economical choice  yet its accuracy of measurement is not satisfying. all of these  mentioned above can provide the time series data that contains the void fraction changing characteristics. the database  used in this experiment     is collected using impedance meter.  in the database  flow regime is classified into   types including bubbly  cap bubbly  slug  churn turbulent  and annular  flow. the database contains     test conditions in total  and each test condition consists of an impedance signal with a  measurement period of    seconds and data acquisition frequency of   khz. for each test condition  signal is ranging  from   to    with   representing full water case and   representing full air case  signal fluctuating between   and    according to the flow regime characteristics.   shows the   second time signal  probability density functions  pdf  and  the cumulative probability density functions  cpdf  to characterize each flow regime. the pdf or cpdf profiles are  usually treated as inputs in som or svm methods.  data augmentation was performed with the original database. two methods are used in this experiment and they are  summarized below.    since the experiment was performed at steady state conditions  meaning that the flow regime state is not  changing during data collection  data could be segmented into shorter pieces. in the following data sensitivity  analysis part  the performance in terms of the length of the data is evaluated and discussed.    the time series signals are reversed in order. in this way  the number of data is doubled.   .     experimental setup    the void fraction signal is firstly put into one relu nn layer for the primary feature extraction. the relu nn layer   or relu layer  stands for feedforward neural network layer with relu as the activation function. then it passes        figure    example of time series void fraction signal  left column   probability density function  middle column   and  cumulative probability density function  right column  for different flow regimes. in each figure  the black and green  curves represent two different test cases belonging to one flow regime. data from    .    through lstm layers and relu layers. the structures of these parts are modified and investigated for the better  prediction. the final output stage of the network is a softmax layer with a size of the number of all possible flow regime.  the networks are established with tensorflow based keras. the optimizer used for all the networks in the experiment is  adam and the loss function is categorical cross entropy.  for the model training  although lstm unit is featured with good preventing of gradient vanishing and exploration   creating and training and good lstm based rnn model require good methods and tricks. some of the important  methodologies used towards building and training a well established rnn model are utilized during the model training.    gate weight initiation  gates are the keys for a lstm unit. gate initial states can have large effect on the  training process. it has been proved that deep neural networks can converge more rapidly using orthogonal  initiation that generates a random orthogonal matrix.        dropout and regularization  to prevent from over fitting and better training the model  the following regularization methods are used  early stopping and learning rate reduction. the training time is largely decreased  due to these two methods. by using early stopping  the training process will stop if testing accuracy has not        been improved for   epochs. with learning rate reduction  the learning rate is initialized as  .   and it can  decease according to the training performance. the minimum learning rate allowed is  .    .     .     sensitivity study    the length of the time series data can affect the flow regime prediction. this is obvious because a very short sequence  may not include all the key information of the characteristics of the two phase flow. however  if the sequence is very  long  the prediction will not be a  real time  prediction. therefore  it is essential to determine the proper length of the  sequence for the flow regime prediction.  different flow regime contains different characteristics and the sequence length needed for each characteristic to be  presented is different. from    the signal variations of typical bubbly and annular two phase flow is small and the  pdf curve contains only one peak. this means that the characteristics of these two phase flows are uniform over the  time and a short sequence could present these characteristics. in contrast  the signal fluctuation of the flow regimes  like slug and churn turbulent two phase flow usually quite large. thus  these flow regimes usually require a longer  sequence. since our objective is to classify the flow regimes  the length of sequence is determined by the flow regime  that requires the longest sequence. besides  other hydrodynamic parameters such as flow rate should also be considered  when determining the sequence length. it is obvious that flow rate determines the speed of the two phase flow passing  through the measurement area  thus affecting the sequence length needed.  in this study  the experimental data are segmented into different sequence lengths and they are used separately for  training the same model structure. the lengths and the training performances are given in table  . the selection of  these lengths is by considering the types of flow regimes and test conditions included in the database. the model  structure used in this section  ltsm  relu  from the table  the prediction accuracy of the model increases as the  sequence length becomes longer. in terms of the performance tendency  the performance of the model trained using  data with   seconds sequence length drastically worsen compared with result of   seconds. this may not be a general  conclusion but it provides a method of determining the input data size.  table    sensitivity study on the effect of sequence length     .     seq.len.   sec.     test accuracy on lstm  relu                          .     .     .     .     result and discussion    eight different rnns were evaluated and their performances of each model are summarized in table  . these models  vary in terms of   aspects  the number of hidden layers  both lstm and relu layers  the number of lstm cells in  each hidden layer. also following       the performance of stacking layers is also analyzed with model  lstm    h relu    and  lstm    h  relu   . the relative prediction time needed for the same number of test cases is  also given in the table.  it can be seen that the test accuracy increases as the network becomes deeper. the accuracy can be improved by adding  either lstm layer or relu layer  and adding lstm layer benefits more than adding relu layer. increasing the  number of cells in each layer can also improve the accuracy. however  increasing the number of layers or number  of cells can also increase the prediction time  which is not good for our general purpose. comparing the network  lstm    h  relu and lstm    h  relu  which we consider the effect of reducing the size of network  the test  accuracy greatly drops from   .   to   .  . this is probably because the number of parameters in the network is  lower than the minimum requirement of modeling the experiment cases. besides  the comparison between adding single  hidden layers and stacking networks  e.g.  lstm    h  relu and  lstm    h  relu     shows that   stacked  network doesn t outperform the   intermediate lstm layer network. however  the author considers that it cannot lead  to a solid conclusion that stacking deep networks is not as beneficial as intermediate hidden layers. the result of this  paper may be affected by the total number of training data. further studies can be performed if more data is available.        table    two phase flow regime classification results         network descriptions    test accuracy        relative prediction time    lstm    h  relu  lstm    h  relu   lstm    h  relu   lstm    h  relu  lstm    h  relu  lstm    h  relu   lstm    h  relu      lstm    h  relu         .     .     .     .     .     .     .     .      .     .     .     .     .     .     .     .      conclusions and future work    the paper developed a methodology of using deep rnns for flow regime prediction that can achieve both accuracy and  fast response. the method could be extended to the prediction with any time series database that records the levels and  the variations of two phase parameters  such as void fraction and interfacial area concentration  over time.    