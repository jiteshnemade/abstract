introduction    the applications of pedestrian trajectory prediction cover a broad range from autonomous driving  robot navigation  smart video surveillance to object tracking.  traditionally  the task of object motion prediction is done by using a bayesian  formulation in approaches such as the kalman filter       or nonparametric methods  such as particle filters    . driven by the success of recurrent neural networks   rnns  in modeling temporal dependencies in a variety of sequence processing  tasks  such as speech recognition         and caption generation          rnns  are increasingly utilized for object motion prediction              . when relying on traditional approaches  the challenge of varying dynamics over time is  commonly addressed with the interacting multiple model  imm  filter    . the  imm filter is a well established approach to elegantly combine a set of candidate  models into a single context by weighting each individual model. each model  corresponds to a specific motion pattern and contributes to the final state estimation depending on its current weight. according to the imm filter solution   in this paper an rnn based imm filter surrogate is presented. on the one hand   the presented rnn based model is able to also provide a confidence value for  the performed dynamic and on the other hand can overcome some limitations of  the classic imm filter. the suggested rnn encoder decoder model generates the  probability distribution over future pedestrian paths conditioned on a dynamic          s. becker  r. hug  w. hu bner  m. arens    class. the model is based on the work of deo and trivedi     . for the case  study of freeway traffic  they used an two branch rnn encoder decoder network  for vehicle maneuver and trajectory prediction. since for vehicle applications an  on board lane estimation algorithm is mostly available  a stationary frame of reference  with the origin fixed at the vehicle being predicted  is used in their work.  although this makes the model independent of road curvature and independent  of how vehicle tracks are obtained  it can not be applied without adjustments  for pedestrian motion prediction. thus  our rnn based model infers like classical filters the current position and uses only a single rnn branch for encoding  the maneuver class  the filtered position and the trajectory information. in the  context of vehicle motion prediction  maneuver or rather dynamic classes can  be better defined than for pedestrians. for example by changing or keeping the  lane. due to the dynamic behavior of pedestrians  the maneuver classes are here  defined based on the deviation from a straight walking pedestrian. the presented  network also extends the maneuver network of deo and trivedi      with insights  from the work of becker et al.     to better adapt to pedestrian motions.  moreover  this paper aims to highlight some relations between traditional multiple model approaches such as the imm filter and the suggested rnn based imm  filter surrogate. by combining the different views on maneuver predictions  this  work contributes to an exploration of the connections between both problem  formulations. the decoder uses the de noised position estimate and a context  vector  encoding the dynamic classes  to predict future positions. the analysis  is done on synthetic data reflecting prototypical scenarios capturing pedestrians  maneuvers.  in the following  a brief formalization of the problem and a description of the  rnn based model are provided. the achieved results are presented in section  .  finally  a conclusion is given in section  .         rnn based imm filter surrogate    the goal is to devise a model that can successfully predict future paths of pedestrians and represent alternating pedestrian dynamics  e.g. dynamics that can  transition from a straight walking to a turning maneuver or stopping. here   trajectory prediction is formally stated as the problem of predicting the future  trajectories of a pedestrian  conditioned on its track history. given an input  sequence z     xt   y t     r   t      . . .   tobs   of tobs consecutive observed pedestrian positions z t    xt   y t   at time t along a trajectory  the task is to generate  a multi modal prediction for the next tpred positions  xt     xt     . . .   xt tpred    and to filter the current position xt    xt   y t  . one insight from the work becker  et al.     is that motion continuity is easier to express in offsets or velocities   because it takes considerably more modeling effort to represent all possible conditioning positions. in order to exploit scene specific knowledge for trajectory  prediction  additional use of the position information is required. when sufficient  training samples from a particular scene are available  hug et al.     showed that  rnn based trajectory prediction models are able to capture spatially dependent     an rnn based imm filter surrogate         behavior changes only from motion data. however  here the offsets are additionally used for conditioning the network z     xt   y t    xt    yt     r   t      . . .   tobs  .  apart from the smaller modeling effort to represent conditioned offsets  the  shift to offsets helps to prevent undefined states due to a limited data range      and it is easier to make better generalizations across datasets. since  we  analyze the model capabilities on synthetic data reflecting prototypical pedestrian maneuvers for a fixed scenario  the amount of training samples is not  restricted. thus  in order to localize in the reference system position information is used to estimate the true position. the future trajectory is denoted with  y     xt   y t     r   t   tobs      . . .   tpred  . the model estimates the conditional  distribution p  y  xt  z . in order to identify specific dynamics under m desired  maneuver classes  e.g. turning maneuvers  stopping and straight walking   this  term can be given by   p  y  xt  z       m  x    p   y  xt  mi   z p  mi  z            i      here        tobs      . . .    tpred   are the parameters of a l component gaussian mixture model  t     tl    lt   wlt  l   ... l . by adding the maneuver context     in form of the posterior mode probability  p  mi  z     i the analogy to the  classic imm filter becomes apparent. for an imm filter  the mode probability  is used to calculate the mixing probabilities to combine the set of chosen candidate models into a merged estimate. the time behavior of the basic filter set is  modeled as a homogeneous  time invariant  markov chain with a fixed transition     probability matrix  tpm  mij   p  mti  mt    j  . under the assumption that m  models describe the variation of the dynamics  the posterior density of the imm  filter can be written as follows   t    p  x  z       m  x    p im m  xt  mi   z p  mi  z            i      here  p im m  xt  mi   z  is in the context of an imm filter a gaussian distri   bution and p  mi  z     i is the posterior mode probability for the imm filter.  as mentioned above  the transition between different dynamics is modeled as a  first order markov chain for an imm filter. the law of total probability allows to  compute new mode probabilities based on the transition probabilities. given the  current mode probabilities and transition probabilities  the mixing probabilities   i j for the mixing step of the imm filter can be calculated. for each model mi  t    and mj   they are calculated as  i j    c  j mij  it   with a normalization factor  pm  c j   i   mij  it   . then  in the prediction stage  each filter is applied independently using the calculated mixed initial condition. subsequently  the model  probabilities are adapted according to the likelihood of each filter.  rnn imm  whereas an explicit modeling of the switching behavior and  the object dynamics of the imm filter stands in contrast to an implicit dy           s. becker  r. hug  w. hu bner  m. arens    namic encoding of an rnn based approach. in order to provide an imm filter  surrogate  the proposed model also estimates mode probabilities and filters or  rather de noises the current position based on noisy observations z. by writing  the conditional distribution p  y  x z  of the rnn based approach in form of  equation    the desired estimates can be inferred from the hidden states of the  rnn h. this formulations does not require to set the parameters of the tpm  matrix manually  which is commonly done based on the mean sojourn time  the  mean time an object stays in a motion type         or as stated in the work of  bar shalom      an ad hoc approach to fill the diagonals with values close to  one. for the proposed rnn based imm filter surrogate  rnn imm   the basic  architecture is a recurrent encoder decoder model. the encoder takes the frame  by frame input sequence z. the hidden state vector of the encoder is updated at  each time step based on the previous hidden state and the current observation.  the generated internal representation is used to predict mode probabilities  t  at the current time step and xt . with embedding of the current observations   the encoder can be defined as follows   etencoder   emb z t   wee    t  htencoder   rnn ht    encoder   eencoder   wencoder      x t    tlogits   mlp htencoder   wen    exp   tlogits      t   pm  t  j   exp   logits j      here  rnn    is the recurrent network  h the hidden state of the rnn   mlp    the multilayer perceptron  and emb    an embedding layer. w represents the weights and biases of the mlp  emb or respectively rnn. the final  state of the encoder can be expected to encode information about the track histories. for generating a trajectory distribution over dynamic modes  the encoder  hidden state is appended to a one hot encoded vector corresponding to specific  maneuvers and the filtered current position. instead of only filtering the position  the encoder could also be used to parametrize a mixture density output  layer  mdl . the decoder of the model can be defined as follows   t  t  t  htdecoder   rnn ht    decoder  hencoder    x        wdecoder      y        tl   x tobs     lt   w lt   t   tobs      . . .   tpred     mlp htdecoder   wde    the decoder is used to parametrize a mixture density output layer  mdl  or  rather   directly for several positions in the future  one distribution for every  time step . nevertheless  the overall rnn imm uses the trajectory prediction  and dynamic classification jointly  the loss function for training is split into three  parts.     an rnn based imm filter surrogate          m     m    mlp  mlp    soft max    filtering x  mlp    lstm    lstm    lstm    lstm    lstm    lstm    lstm    lstm    lstm    t    trajectory  encoding    lstm  lstm  lstm  lstm  lstm  lstm    z t      z t      maneuver  encoding    zt    fig.  . visualization of the rnn based imm filter surrogate  rnn encoder decoder  network  for jointly predicting specific dynamic probabilities and corresponding future  distributions of trajectory positions. the encoder predicts the dynamic probabilities  and the filtered position for the current time step. the decoder uses the context vector  and the position estimate to predict future pedestrian locations.    dynamic classification is trained to mimimize the sum of cross entropy losses  of the different m motion model classes     l z maneuver        m  x    t   j gt  log   jt             j      additionally  the encoder is trained by minimizing the filtering loss l z f ilter  in form of the mean squared error to the ground truth current pedestrian locations. in case the encoder should generate the parameter of a mixture of gaussian  or single gaussian distribution  the negative log likelihood for the ground truth  pedestrian locations can be minimized. finally  the complete encoder decoder is  trained by minimizing the negative log likelihood for the ground truth future  pedestrian locations conditioned under the performed maneuver class. the context vector is appended with the ground truth values of the dynamic model or  maneuver classes for each training trajectory. this results in the following loss  function     l z pred     log p   y  mgt   z p  mgt  z    tpred    l z pred      x  t tobs       l  x    log   w lt n  xt    tl   xtobs     lt   mgt     l                   s. becker  r. hug  w. hu bner  m. arens    the overall architecture is visualized in figure  . the context vector combines  the encoding of the track history with the encoding of the alternating dynamic  classes. together with the filtered position  it is used as input for the decoder.         data generation and evaluation    fig.  . illustration of typical pedestrian motions. the above images depict the two  chosen maneuver classes of straight walking or rather crossing and stopping. the images  on the left show a person crossing the street. the images on the right show a person  changing from walking to standing at the curbside of the street. in particular changing  from straight walking to stopping     .    this section consists of a brief evaluation of the proposed rnn imm. the  evaluation is concerned with verifying the overall viability of the approach in  maneuver situations. for initial results  a synthetic test condition is used in order to gain insight into the model behavior in different typical pedestrian motion  types. a prototypical maneuver performed by a pedestrian  which has important implications for the field of intelligent vehicles and video surveillance is a  stopping or deceleration maneuver.     an rnn based imm filter surrogate         data generation and reference methods  for the first mentioned context of intelligent vehicles  schneider et al.      performed a comparative study  on recursive bayesian filters for pedestrian path prediction at short time horizons  below   seconds . they applied different filters on typical pedestrian motion types. although  the comparison was done on the daimler path prediction  dataset  we evaluate on synthetic data but make use of the provided real data to  capture a similar condition. firstly  the daimler path prediction dataset provides  only a maximum amount of    sequences for single motion types. as mentioned  before  in order to avoid problems such as a limited number of training samples  and to gain some insights into a controlled setup  synthetic data is used. secondly  the location information is biased in the dataset. since recursive bayesian  filters make in their standard formulation no use of the spatial context of a scene   this does not harm their mutual comparison. however  rnn based prediction  networks are able to capture spatially dependent behavior changes       thus a  fair comparison is difficult to achieve. the evaluation on the daimler dataset is  done in an ego motion compensated reference system. the frame rate of the camera system inside the recording vehicle is    fps and it is taken over accordingly  for our experiments. the pedestrians change their behavior abruptly. therefore   the sensible time horizons are short. here      .  seconds  consecutive positions  are observed  before predicting the next     . s seconds        .   seconds  and        second .  for generating synthetic trajectories of a basic maneuvering pedestrian  random agents are sampled from a gaussian distribution according to a preferred  pedestrian walking speed       n       m   .  m   from the distribution of starting positions of the corresponding daimler dataset sequences. during a single  trajectory simulation the agents can perform a stopping maneuver or cross the  street. figure   illustrates such maneuvers with example images from the daimler dataset     . for mapping the pedestrian detections to a vehicle motion compensated ground plane  schneider et al. used on board sensors for velocity and  yaw rate and a stereo camera system to compute the median disparity. due to the  non linear observation model based on a perceptive camera model  an inevitable  linearized extension for the kalman and imm filter observation models are required. here  the observation uncertainty of the position sensor is assumed to  be gaussian distributed rt   n      .  m  in the compensated reference system.  thus  the standard formulation of the bayesian filters are well suited for this  task. for the stopping maneuver or rather the event of deceleration till standing   a mean sojourn time of   second with a standard deviation of  .  seconds is used.  as long as a person moves in a straight line at a reasonably constant speed  their  dynamics can be captured with a kalman filter using a constant velocity model.  during the maneuver  the relation to one fixed process model describing the dynamics fails due to an additional deceleration. similar to schneider et al.      or  kooij et al.       the reference imm filter is set up by combining two basic models  in particular  the constant velocity  cv  and the constant acceleration  ca   model. for avoiding side effects due to independent motions in different directions  see for example      only the crossing direction  from the vehicle perspec           s. becker  r. hug  w. hu bner  m. arens    tive  the lateral motion is considered. following the aforementioned explanations   the imm rnn is compared to an imm filter with two motion models  cv  ca    a kalman filter with a single cv model  a kalman filter with a single ca model   and as baseline to a linear interpolation. also correspondingly to schneider et  al.  the process noise q is determined by q t    q   t q  where q     cv    ca    are spectral densities  continuous time variances  of the process noise  describing  the changes  in   velocity or respectively       in acceleration over a sampling period  t      cv  q      t   q  ca  q      t   q  see for example      . based on this  process noise model  the optimal process noise parameters for the different chosen filters  imm filter  cv  ca   kalman filter cv  ca  on the daimler dataset  are for the two imm filter models  im m cv    .     im m ca    .   and for  the single kalman filters  cv    .   and  ca    .       . these parameters are  consistent with the suggested practical setting in bar shalom     and the chosen  sojourn time for the simulation.  as mentioned above  a definition of maneuver classes for pedestrians is harder to  establish than for vehicles. hence  the main interest is here to detect the deviation from a standard behavior  and whether the pedestrian is in a normal mode.  a set of deviation in velocity  deceleration  along with the tangential ground  truth trajectory is used to assign a maneuver label to a time step of a single  trajectory. thus  the rnn imm and imm filter have a similar basic dynamic  model set description. as the distribution over the trajectories for the rnn imm  is captured with a gaussian mixture model  the maneuver description for a single model can still be multi modal. since the imm filter predicts a multi modal  distribution in form of a combination of the uni modal model specific prediction   in the presented results the rnn imm is set to also only predict conditioned on  a single maneuver class a uni modal gaussian distribution.  implementation details  the model has been implemented using tensorflow     and is trained for      epochs using adam optimizer      with a  decreasing learning rate  starting from  .   with a learning rate decay of  .    and a delay factor of     . during the learning rate adaption  the number of  epochs is multiplied by the delay factor. for the experiments  the rnn variant  long short term memory  lstm       is used.  results   analysis  in figure    predictions for two different preformed  motion types are depicted for   future positions weighted by the predicted maneuver probability. in the shown images the positions are normalized to start at  the origin. the resulting multi modal prediction is visualized as a heatmap. on  the left  it can be seen that for a crossing sequence with straight walking the  rnn imm mainly uses the corresponding straight walking model. on the right   where the deceleration started  the straight walking probability is visibly lower  and the predicted distribution maximum is very close to the last observation.  for the quantitative evaluation       noisy trajectories have been synthetically  generated  where    percent are used for training and    percent for the comparison to the recursive bayesian filters. the results are summarized in table  .          y in meters    y in meters    an rnn based imm filter surrogate    x in meters    y in meters    y in meters    x in meters    x in meters    x in meters    fig.  . visualization of the predicted multi modal distributions of future position as  heatmap.  left  density plots for crossing or rather straight walking examples.  right   density plots for stopping examples in which the maximum of the predicted distribution  is visible close to the last observation.    the performance is compared with the final displacement error  fde   see for  example       of the lateral motion  from the vehicle perspective  for three different time horizons  in particular   steps   . s      steps   .  s  and    steps   s .  these results show that the presented rnn imm is able to faster capture the  change in dynamic for the synthetically generated data. in terms of the single  motion models  cv vs. ca   one can observe the benefits for the ca in capturing the deceleration. the imm filter combines both and shows an improvement.  hence  the aim of this paper is more on highlighting the relation between traditional multiple model approaches and the suggested rnn based imm filter  surrogate  it should be mentioned that rnn based approaches are designed to  receive input data for every time step  whereas bayesian filters are well suited for  handling missing observations. especially with such a short initialization time   this can be crucial. one argument towards a learning based rnn imm is that  we only choose the maneuver definition based on deviation of standard straight  walking. the engineering task of finding the best model set up for imm filters  and their extensions can lead to an improved behavior  see for example keller  et al.       in specific maneuver situations  but is also very tedious to find a  good setting. it should also be mentioned that recent work like the approaches  of kooij et al.      show options how to further improve the prediction performance by including scene context and using more cues than pedestrian point  kinematics  e.g. head orientation  gaze  body tilt  articulated body information .           s. becker  r. hug  w. hu bner  m. arens    table  . results for the comparison between the proposed rnn imm and an imm  filter with two motion models  cv  ca   a kalman filter with a single cv model  a  kalman filter with a single ca model  and using linear interpolation on the simulated  maneuver situations. the prediction is done for        and    time steps conditioned  on   observations for a frame rate of    fps.    approach  rnn imm  imm filter  cv ca   kalman filter  ca   kalman filter  cv   linear interpolation         fde  m   fde  m    .      .       .      .       .      .       .      .       .      .              fde  m   fde  m    .      .       .      .       .      .       .      .       .      .              fde  m   fde  m    .      .       .      .       .      .       .      .       .      .        in summary  the presented rnn imm is able to also provide a confidence     value p  mi  z     i for the performed dynamic  but avoids modeling the dynamic transitions with a fixed transition probability matrix p  mti  mt    j  . similar  to the provided mode probabilities of imm filters  this can be used for further  processing steps or rather applications  see for example        . further  instead  of choosing the basic filter set  the prediction model is learned. in case there exists some well known model for describing the standard dynamic of the desired  target  only deviations from the known dynamic can be used to define additional  maneuver classes. this study on synthetically generated data shows  that by exploiting the connections between different views on maneuver prediction some  perspectives on overcoming respective limitations can be gained.         conclusion    in this paper  an rnn encoder decoder model  which can be interpreted as an  imm filter surrogate  has been presented. the rnn imm is able to jointly predict specific motion probabilities and corresponding distributions of future pedestrian trajectory. the model capabilities were shown on synthetic data that were  reflecting typical pedestrian maneuvers. by conditioning on specific dynamic  models or rather deviation from standard behavior  the model makes it possible  to generate additional information in terms of an assigned maneuver probability  similar to an imm filter  but reduces the amount of explicit modeling of filter parameters  e.g. the dynamic transitions matrix . thus  the presented rnn imm  helps to reduce the amount of hard coded engineering of traditional multiple  model filter such as the imm filter.    