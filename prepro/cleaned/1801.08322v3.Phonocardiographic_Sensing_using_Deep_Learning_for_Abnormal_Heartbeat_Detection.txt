introduction  cardiovascular diseases  cvds  are the major health problem and have been the leading cause of death globally.  they are causing nearly     deaths in europe        .    in america      and more than     in developing countries     . earlier diagnosis of cvds is crucial as it can drastically  decrease the potential risk factors of these deaths    .  auscultation is an widely used method for cvd diagnosis   which uses stethoscope to find out clues of different cardiac  abnormalities. however  it requires extensive training and experience for proper auscultating    . only    to     accuracy  can be achieved when performed by medical students and  primary care physicians           and roughly     can be  achieved when conducted by expert cardiologists         .  another effective solution is echocardiograms that visualize  the heart beating and blood pumping. however  this procedure  is expensive with an average cost of       as per current cost      . overall  there is a distinctive lack of a reliable yet costeffective tool for earlier diagnosis of cvd.  a potential solution to the above mentioned problems is  a sensor enabled automated diagnosis in real time using mobile devices and cloud computing           . in fact  this  has inspired the development of phonocardiography  pcg    which is now an effective and non invasive method for earlier  detection of cardiac abnormality     . in pcg  heart sound    is recorded from the chest wall using a digital stethoscope  and this sound is analyzed to detect whether the heart is  functioning normally or the patient should be referred to  an expert for further diagnosis. due to its high potential   automatic detection of cardiac abnormalities through pcg  signal is a rapidly growing field of research     . most of  these automated cardiac auscultation attempts  however  have  utilized either classical machine learning models  e.g.               or feed forward neural networks            rather than  recurrent neural networks  rnns  which are intrinsically  better suited for this task.  heart sound is a physiologic time series and it possesses  temporal dynamics that change based on the different heart  symptoms. due to their well known capabilities for modeling  and analyzing sequential data even in the presence of noise        in this paper we explore various rnns for automated  cardiac auscultation. we use      physionet computing in  cardiology challenge dataset      that contains phonocardiograms recorded using sensors placed at the four common  locations of human body  pulmonic area  aortic area  mitral  area  and tricuspid area. the work presented in this study is  the first attempt that investigates the performance of various  state of the art rnns for heartbeat classification using pcg  signals.  ii. r elated w ork  in the past few years  automatic analysis of phonocardiogram  pcg   which refers to the high fidelity sound recording  of murmurs made by the heart  has been widely studied  especially for automated heartbeat segmentation and classification. according to liu et al.      there was no existing  study that applied deep learning for automatic analysis on  heartbeat before the      physionet computing in cardiology  challenge. now there are few attempts using deep learning  models for classifying normal and abnormal heart sounds   which we describe next.  a deep learning based approach was used in      for  automatic recognition of abnormal heartbeat using a deep  convolutional neural network  cnn . the authors computed  a two dimensional heat map from one dimensional time series of pcg signal with the overlapping segment length of  t     seconds and used for training and validation of the  model. they achieved the highest specificity score  .              as compared to all entries made in physionet computing in  cardiology challenge but their sensitivity and accuracy scores  were low   .     and  .      respectively.  a fully connected neural network  nn  consisting of     hidden layers was used in      for the classification of pcg  signals. the authors achieved the recognition rate of     with  the specificity of    and poor sensitivity of   . potes et al.       used an ensemble of adaboost and the cnn classifiers to  classify normal abnormal heartbeats. this ensemble approach  achieved the highest score in the among others and achieved  rank one in the competition with the specificity  sensitivity   and overall score of  .       .      and  .      respectively.  other approaches in this challenge were based on the classical  machine learning based classifiers. interestingly  none of the  above studies have attempted rnn  which is  however  the  most powerful model for time series data.  rnn architectures such as long short term memory   lstm  and gated recurrent units  gru  have not been  used for pcg analysis but they have achieved state of the art  performances in various other applications with sequential data  including speech recognition             machine translation              and emotion detection     . bidirectional long  short term memory  blstm        which processes the  information in both directions with two different lstm layers  show even better performance than lstm and other conventional rnns in phoneme classification and recognition     .  moreover  deep blstms with the objective function of connectionist temporal classification  ctc  are very effective in  optimizing word error rate in speech recognition system with  no prior linguistic or lexicon information     . bidirectional  gated recurrent units  bigrus  have also been used for  audio processing. they achieved a significant improvement in  the performance of sound events detection from the recording  of real life  by capturing their temporal boundaries     .  iii. p roposed a pproach and rnn m odels  our proposed approach for heart sound classification using  rnns is depicted in figure  . the heart sound is first  prepossessed for first and second heart sounds  s  and s    respectively  detection and segmented into smaller chunks.  features extracted from these segments are given to the  rnns for classification  which classifies these into normal or  abnormal.    grid like structures  such as  images. it takes an input sequence  x t     x    .....  xt   and at the current time step t calculates  the hidden state or memory of the network ht using previous  hidden state ht   and the input xt . the outputs from rnn  are projected to the number of classes. a softmax function is  used to project the output vector into the probability vector  having values in      . when rnns are used for abnormal  heartbeat detection  its end layer is projected to the number  of classes  normal and abnormal . given a series of heart  signal x t     x    .....  xt    an rnn classifier learn to predict  hypotheses y  of true label y. the standard equations for rnn  is given below   ht   h wxh xt   whh ht     bh             yt    wxh xt   by             where w terms are the weight matrices  i.e.  wxh is weight  matrix of an input hidden layer   b is the bias vector and h  denotes the hidden layer function.     long short term memory  lstm  units  the lstm       network is a special type of rnn that consists of a  recurrent memory block to store representations for extended  time intervals. a memory block consists of three gates  input   output and forget gate. these multiplicative gates learn to  control the constant error flow within each memory cell. the  memory cell decides what to store  and when to enable reads   writes and erasures of information. graphical representation  of lstm memory cell is shown in figure  a.  when features from a sequence of heart signal are given to  the network  each lstm unit holds a memory ct at a specific  time t. the activation function is given by   ht   ot tanh ct             the output gate ot modulates the memory content and calculated by      ot     wxo xt   who ht     wco ct   bo       the forget gate ft control the memory in the network and  update it by forgetting the existing memory ct with the  incoming information.     ft     wxf xt   whf ht     wcf ct   bf       the extent of incoming information is controlled by the input  gate it     it     wif xt   whi ht     wci ct   bi       the existing memory in the network is finally updated by the  following equation under the control of these three gates.     ct   ft ct     it tanh wxc xt   whc ht     bc         figure    block diagram of proposed approach  a. recurrent neural networks  rnns   recurrent neural networks  rnns  are specialized to process sequences  unlike the cnns  which are specialized for       gated recurrent units  grus   the gated recurrent  unit  gru       is a slightly simplified version of lstm  that combines the input and forget gates into a single gate  known as update gate. gru architecture has an additional reset  gate as compared to lstm  see figure  b . grus control the  information flow from the previous activation while computing  candidate activation but unlike lstm do not control the  amount of incoming memory using the forget gate.           b      c      a     figure    graphical representation of   a  lstm memory cell    b  gated recurrent unit  gru     c  bidirectional lstm.    b. bidirectional recurrent neural networks  one shortcoming of standard rnns is that they can only  use previous information for making decisions. bidirectional  rnns      using lstm units or grus can process the  information both in the forward and backward direction which  enable them to exploit future context. this is achieved by com      puting the hidden sequence both in forward h and backward        direction h   and updating the output layer using backward  layer from time step t   t to   and forward layer from t      to t  see figure  c .  similarly  a bidirectional gru  bigru  exploits the full  use of contextual information and produces two sequences   hf    hf    .....  hft   and  hb    hb    .....  hbt   by processing the information both in forward and backward directions  respectively.  these two sequences are concatenated at the output by the  following equation         gru  x     hf    hbt   ...  hft   hb   .             here  the gru  x  term represents the full output of bigru  produced by concatenating each state in forward direction hfi  and backward direction hb t  i    at step i given the input x.  in this paper  we use both rnns and bidirectional rnns and  compare their performances on abnormal heartbeat detection.  iv. e xperimental p rocedure  the performance of different rnn models is evaluated on  the publicly available datasets. the details of the datasets and  experimental procedure are presented in this section.  a. database description  to evaluate the proposed methodology  the largest dataset  provided at the  physionet challenge            has been  used. the physionet dataset consists of six databases  a  through f  containing a total of      raw heart sound recordings. these recordings were independently collected by different research teams using heterogeneous sensing equipment  from different countries both in clinical and nonclinical  i.e.   home visits  settings. the dataset contains both clean and  noisy heart sound recordings. the recordings were collected  both from healthy subjects and patients with a variety of heart  conditions  especially coronary artery disease and heart valve    disease. the subjects were from different age groups including  children  adults and elderly. the length of heart sound recordings varied from   seconds to just over     seconds. for our  experiments  we use all six databases containing normal and  abnormal heart sound recordings.  b. preprocessing of heart sound  the heart sound recorded by electronic stethoscope often  has background noise. the preprocessing of heart sound is an  essential and crucial step for automatic analysis of heartbeat  recordings. it reveals the inherent physiological structure of the  heart signal by detecting the abnormalities in the meaningful  regions of pcg signal and allows for the automatic recognition  of pathological events. the detection of the exact locations  of the first and second heart sounds  i.e.  s  and s   within  pcg is known as the segmentation process. the main goal of  this process is to ensure that incoming heartbeats are properly  aligned before their classification as it significantly improves  the recognition scores     .  in this paper  we used state of the art method logistic  regression hidden semi markov models  hsmm  for identification of heart states proposed by springer et al.     . this  method uses lr derived emission or observation probability  estimates and provides significantly improved results as compared to the previous approaches based on the gaussian or  gamma distributions           .  the working of logistic regression hsmm is similar to  svm based emission probabilities      and it allows for  greater discrimination between different states. logistic regression is a binary classifier that maps the feature space or  predictor variables to the binary response variables by using  a logistic function. the logistic function   a  is defined as     a              exp   a            the probability of a state or class given the input observations  ot can be defined using the logistic function                  p qt     ot     w ot  .  the term w represents the weights of the model that are  applied to each observation or input features. the model  is trained iteratively and re weighted least squares on the          training data. for one vs all logistic regression  the probability  of each observation given the state bj  ot   j   is found by using  bayes rule                 p qt     ot   p ot     bj  ot     p ot  qt        .       p  j  the p  ot   is calculated from a multivariate normal distribution of the entire training data and p   j   is the initial state  probability distribution.  the logistic regression hsmm algorithm use the combination of four type of features  homomorphic envelope   hilbert envelope  wavelet envelope and power spectral density  envelope. the details of these features can be seen in     . the  overall pcg recordings are given to the model for accurate  detection of most probable states  i.e.  s  and s  .    figure    four states  s   s   systole  and diastole  of the heart  cycle using logistic regression hsmm  figure   shows the detected four states  i.e.  s   s   systole   and asystole  of two heart cycles. note that  generally  it is  called as s  and s  detection  although it detects all the four  states  s   s   systole  and asystole. the blue line is for the  heart signal and the black line shows the detected states using  logistic regression hsmm algorithm.  c. segment extraction  after detecting the position of heart states  we segmented  the overall pcg waveform into shorter instances by locating  the beginning of each heartbeat. this is because the number  of audio recordings  i.e.        of heart signal is not adequate  to evaluate rnns for designing a robust system. segment  extraction was also used in previous studies to divide the  overall heart sound in smaller chunks. for instance  rubin  et al.      used a segment of t     seconds for training  and validation of cnn. in this paper  we segmented the  heart signal into three sequences of heart cycles        and  .  these segments contain enough information and at the same  time small enough to generate many samples for training the  model. figure  a    b shows the five cycles of normal and  abnormal heart sound  respectively. the abnormal heart sound  is different from the normal one in temporal context. it has  heart cycle states of longer duration in the segment.  d. feature selection  the extraction and selection of more relevant parameters  from pcg signals are crucial tasks. they significantly affect    the recognition performance of the model. in this paper we  used mel frequency cepstral coefficients  mfccs       to  represent pcg signal in compact representation. mfccs are  used almost in every study on automatic heart sound classification  for example                   due to their effectiveness  in speech analysis. we compute mfccs from   ms of the  window with a step size of   ms. we select the first    mfccs  for compact representation of pcg signal as a large feature  space does not always improve the recognition rate of the  model     .  e. model parameters  we built our models using keras      with a tensorflow  backend     . in order to find the best models  structure  we  evaluated a different number of gated layers from one to four.  a smaller model with only one lstm or gru layer was  not performing well on this task. experiments with a larger  number of gated layers and dense layers also failed to give  improvements in performance. this might be due to overfitting  problem. we got the best classification results using   gated  layers for both lstm and gru models. therefore  our lstm  and blstm models consist of two lstm layer with tanh  function      as activation. for each heartbeat  the outputs of  lstm or blstm layers were given to the dense layer and  the outputs of this layer were given to the softmax layer for  classification  refer to section iii .  we trained all these models using the training portion of  the dataset and development portion of the data was used  for hyper parameter selection. we started training the network  with a learning rate of  .    and learning rate was halved  after every   epochs if the classification rate of the model did  not improve on the validation set. this process continued until  the learning rate reached below  .      or until the maximum  epochs i.e.      were reached. we used batch normalization after the dense layer for normalization of learned distribution to  improve the training efficiency     . in order to accommodate  the effect of initialization  we repeated each hyperparameter  combination for three times and used the averaged prediction  for validation and testing.  v. r esults and d iscussion  the overall dataset of physionet computing in cardiology  challenge consisted of eight heart sound databases gathered  from seven different countries. there is a total of      publicly  available heartbeat recordings. we detected heart states in  each pcg waveform and segmented these signals into smaller  chunks containing exact five heart cycles. mfccs were computed from these chunks and both models were trained on      of data      data was used for validation and remaining      of data was used for testing. as each model was trained  on mfcc computed from the smaller segment  to predict  the score for full instance  an averaging was performed on  posterior probabilities of the respective chunks. in this work   the accuracy of rnns has been tested on three different cycles         and   in a heart signal  see figure   . all rnn models  consistently performed well on   cycles. therefore  onward  we mention results using   cycles.           b      a     figure    extracted segments of five heart cycles using   a  normal and   b  abnormal heartbeats. abnormal heart cycles  have longer duration.    b. comparison with non recurrent deep models  we compare the performance of rnns with most recent  studies on pcg classification using dnns in table ii. it can  table ii  comparison of results with previous attempts.  author  year   potes et al.               tschannen et al.               rubin et al.               nassralla at al.               dominguez at al.               our study           figure    accuracy using different number of heart cycles   where rnns give best results using   cycles.    a. baseline models  in order to compare the performance of rnns  we selected  three classic powerful classifiers  logistic regression  lr    support vector machines  svm   and random forest  rf   as baseline models. we trained these models on mfccs  computed from   heart cycles. in svm  we tested three  kernels  linear  polynomial  and radial basis function  rbf   to obtain the best classification results. hyperparameters of  these models were selected using validation data. table i  shows the best results obtained by these models and presents  a comparison with rnns. we observe rnns significantly  outperform all three models in every performance measures.  table i  comparison of svm and lr with rnn  model  svm  best   lr  best   rf  best   rnns  best     sensitivity   .       .       .       .        specificity   .       .       .       .        accuracy   .       .       .       .        approach  adaboost  and cnn  waveletbased cnn    sensitivity    specificity    accuracy     .         .         .         .        .        .       cnn     .         .         .        dnns     .       .       .       .         .         .         .       .       .       .         .       .       .       .         .       .       .       .        modified  alexne  lstm  blstm  gru  bigru    be clearly noticed that rnns outperform all deep learning  models used on heart sound classification with a significant  improvement. worth mentioning  heart sound classification  using the ensemble of adaboost and cnn achieved  rank     in physionet computing in cardiology challenge       with the best recognition rate. in our approach  rnns using  lstm and even with grus have achieved better recognition  rate than that in every performance measures.  c. performance comparison of rnns  in this study  our evaluation focused on the sequence modeling of heart sound using rnns. we explored the performance  of different state of the art rnns for this task. based on the  experimental results  it can be highlighted that the different  rnns have achieved comparable performances. however  out  of all models  blstms perform consistently well and is  preferred for heartbeat classification using pcg. another important finding  despite having a simpler architecture compared  to lstm  the performance of gru is also promising on pcg  data.  vi. c onclusion  in this paper  we conduct an empirical study on abnormal heartbeat detection using pcg signal and demonstrate           a      b     figure    performance comparison of rnns on heartbeat classification    a  lstm vs gru and   b  blstm vs bigru.    that recurrent neural networks  rnns  produce promising  results. in particular  the results are significantly better than  the conventional deep learning models. rnns have the most  important architectures to capture the temporal statistics and  dynamics in the sequence of heartbeats more efficiently as  compared to the other popular dnns like cnn. noteworthy   the rnn models significantly outperform the adaboost cnn  model which was placed rank   in the physionet computing  in cardiology challenge     . in our future studies  we aim  to produce further empirical evidences of why rnns are  promising for heartbeat classification.  