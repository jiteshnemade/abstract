introduction  modern industrial control systems  ics  deals with multivariate time series data of technological processes  sensors and controls signals. comprising a cyber components   icss are a target of cyber attacks  for example  lee et al.           that can modify sensor and controls values  or the  parameters of control logic  set points . such cyber attacks  can be detected as an anomalies in technological signals.  this raises the issue of early anomaly detection.  different approaches have been proposed to detect anomalies in industrial data. anomalies can arise for different reasons  besides cyber attacks  equipment malfunctions  human errors  analogous signals interruptions  etc. here we  provide only a short overview of such approaches  rnnbased  nanduri et al.         lstm based forecasting   filonov et al.        malhotra et al.        and encoderdecoder  malhotra et al.         clustering based  kiss  et al.         pca  dpca  fda  dfda  cva  pls  chiang et al.         one class svm and segmentation  marti  et al.         change point detection  matteson   james          process invariants  adepu   mathur       .       kaspersky  lab   moscow   russian  federation.  correspondence to   andrey lavrentyev  andrey.lavrentyev kaspersky.com .  icml      time series workshop  sydney  australia      .  copyright      by the author s .    one of the main problems with the verification of proposed  approaches is the lack of available industrial datasets with  labelling of normal and anomalous behaviour as well as  the absence of rich anomalous behaviour examples. finding data from real objects under cyber attacks is problematic because these are quite unique incidences and industry  vendors do not want to share such data. experimenting  with attacks on real test objects is not a solution because it  is very costly. one of a possibility for generating anomalous behaviour is data augmentation as in  yadav et al.        . another possibility is to use a mathematical model  of a cyber physical system for both physics and control dynamics and simulate multiple realistic cyber attacks. in our  previous work  filonov et al.        we used this approach  with a gasoil heating loop process  ghl   ghl         implemented with the modelica tool. the generated data  is quite rich but it lacks of some stochastic properties and  reflects a rather simple control logic.  in the current paper we use the well known tep model   downs   vogel        ricker        which allows rich  and realistic datasets to be generated. cyber attack simulation using tep was proposed in  krotofil        and  implemented in the matlab simulink tool and .net code.  we used our own implementation of the tep model completely in python code which allowed us to simulate a lot of  cyber attacks and generate datasets as well as a streaming  data.  to detect anomalies in tep data we further developed the  rnn based forecasting approach that we used for ghl  data. tep data requires the rnn network to be adapted in  order to deal with stochasticity  stationary and transitive behaviours. we also focused more on early detection and for  this purpose used numenta anomaly benchmark  nab   metric  lavin   ahmad       . we provide a comparison with the fault detection approach traditionally used for  tep based on dpca  chiang et al.         and which we  combined here with the nab metric.     . dataset description  the tep model is represented in figure  . it was simulated  at different normal modes and under cyber attacks. the  generated datasets characteristics are represented in table   .     rnn based early cyber attack detection for the tennessee eastman process          time series dimension                          sensors  meas   measurements   controls  mv   manipulated variables   meas attack indicator  mv attack indicator  sp  set point  attack indicator  special variables  state  product rate  hourly cost   plant modes             normal modes  transient modes  attack types  dos  value is frozen   integrity  value is changed   noise  value   noise     figure  . tennessee eastman process    attack series     type  mv meas sp  duration     we generated a training dataset with     single mode and      transient mode samples and a test dataset with      meas mv sp attacks samples  tep       . each sample is a multivariate time series of dimension   . besides  samples for   single modes of tep operation we generated  samples for    transient modes via   variants of sp changes  for each single mode  decreasing by    catalyst c purge   changing product mix by      decreasing product rate by       decreasing reactor pressure by       . indicators of  attacks in the test dataset are equal to  .  at the intervals of  corresponding attacks  to meas  mv or sp . there were  three kinds of attacks used at the meas and mv  a  integrity  changing a value to something different from that  simulated by the tep model  b  dos  denial of service   at  some point a value of a variable is frozen for the duration  of an attack  c  noise  add nose to value.  an attack on an industrial plant can very quickly reach a  critical situation where further model simulation becomes  impossible and the plant operation must be stopped. in order not to make the task of detection too simple  we tuned  the attack intervals so that the plant could return to a level  of stable operation after an attack  and proposed four series  of attacks.     . rnn based anomaly detection  we use rnn based forecasting model. anomaly detection  is made on the base of mse  mean square error  between  prediction and observation.         integrity  meas  reactor temperature     .     .    h       dos  mv  stripper liquid product flow    meas  stripper level    meas  stripper underfow    .      .    h       dos  mv  d feed flow      h       noise  mv  c feed flow   mv  purge flow    meas  stripper underfow    mv  stripper steam flow    .        .    h          points per hour  training set  duration hours                 samples with one normal mode      h   samples with transient mode      h   test set  duration hours            samples with attacks         h  till broken   table  . tep dataset characteristics    input window w as         exp    lnw   .  the minimal detection threshold value is calculated as   .    quantile from the smoothed error in the training  dataset.   . . rnn architecture and training  to cope with the tep dataset  we adopted the previously  used lstm architecture for the ghl dataset in a way that  is represented in table  .    input data is normalized  parameters are calculates based  on the training dataset .    for both datasets we use stacked rnn with   hidden layers   each with    cells. the input window is equal to the prediction window. relu as an activation function for hidden  layers and linear activation function for the output layer are  used.    prediction square error is summarised and smoothed with  emwa. smoothing factor   is calculated using the size of    to train rnn we use mse loss function and the rmsprop  algorithm. learning step equals  .   . number of epochs     . . pre  and post  processing     rnn based early cyber attack detection for the tennessee eastman process    dataset  ghl  tep    cell    layer    memory    dropout    window    lstm  gru     x     x      stateful  stateless     .   no                table  . rnn architecture for ghl and tep datasets    equals    . average time of one training epoch is    seconds with batch size        and hardware tesla p    intel xeon cpu e       v   .  ghz. the resulting dependency of loss functions vs epoch for training and validation  datasets is represented in figure  .    figure  . example of rnn prediction  green  for a single mode  normal behaviour sample    figure  . loss function value vs epoch number for training  loss   and validation  val loss  datasets    examples of trained rnn model prediction for a single  mode normal behaviour sample is represented in figure     for a transient mode sample in figure    and for an meas  attack sample in figure  .   . . quality metric  to compare the results of different anomaly detection approaches we selected the nab metric that scores in range  s      .    .    s    .  if detection is at the anomaly  beginning  s    .  if detection is at the end of anomaly  window  s      .    .   if detection is not too far from  the end of anomaly window  s     .  otherwise . table    shows standard profile weights  lavin   ahmad         for tp  tn  fp  fn for the nab metric.    true  false    positive   .    .      negative   .    .     table  . standard profile weights for the nab metric    experimenting with different kinds of attacks on the tep  we observed that the anomaly window is not necessary  equal to the attack interval. quite often the consequence of  an attack  which is also anomalous behaviour  continues after the attack has stopped. so  selecting a correct anomaly  window for the nab metric is quite a tricky process. to  average this out we use an anomaly window equal to twice  the attack interval.  the rnn based detector was tested under different detection thresholds. several cyber attacks datasets were concatenated in one.   . . comparison with dpca  working with the ghl dataset we found that the most successful alternative to the lstm based approach is pca.  here we compare our rnn based approach with dynamic  pca  dpca .  dpca parameters are  time window size       space dimension        number of main components       kaiser  rule      .  .  with dpca we were only able to train separate models for  each tep single operation mode. for transient mode we  faced with many false positives  fp  detection with dpca.  so  we ignored that cases and calculated scores for dpca  as an average of the scores for each single mode  m    dpca         x  m      dpca m      rnn based early cyber attack detection for the tennessee eastman process    figure  . example of rnn prediction  green  for a transient  mode normal behaviour sample    figure  . example of rnn prediction  green  for an measattack sample    we tested rnn and dpca on the tep dataset using the  nab metric. anomalies detections results are shown in  table  .    trained only for a separate single mode  and for a transient  mode dpca gives many false positives  fp . from a practical point of view of industrial anomaly detection application  it is more convenient to have one trained model for  all kinds of plant modes  what we achieved only with rnn  approach.    method  attacks series   ideal detector  rnn  all   dpca  all   rnn  except       dpca  except         nab score   .      .      .      .      .       table  . rnn vs dpca nab scores    the generated tep datasets with normal and anomalous  behaviour caused by cyber attacks are made publicly available.    acknowledgements    we connect the decrease in the rnn and dpca detection  score in the nab metric for attacks on mv       d feed  flow dos   with the tep physics  i.e. the consequences of  control changes taking place for quite a long time after an  attack.    the authors are sincerely grateful to konstantin kiselev for  the implementation of the tep model on python and artem  vorontsov for useful discussions.     . conclusion    